<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs4/dt-1.10.18/b-1.5.2/cr-1.5.0/fc-3.2.5/fh-3.1.4/kt-2.4.0/sc-1.5.0/sl-1.2.6/datatables.min.css"/>

    <title>Crud DEMO</title>
  </head>
  <body>

   <div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
     <h5 class="my-0 mr-md-auto font-weight-normal">Company name</h5>
     <nav class="my-2 my-md-0 mr-md-3">
       <a class="p-2 text-dark" href="#">Features</a>
       <a class="p-2 text-dark" href="#">Enterprise</a>
       <a class="p-2 text-dark" href="#">Support</a>
       <a class="p-2 text-dark" href="#">Pricing</a>
     </nav>
     <a class="btn btn-outline-primary" href="#">Sign up</a>
   </div>

   <div class="pricing-header px-3 pt-md-5 pb-md-4 mx-auto text-center">
     <h1 class="display-4">Demo</h1>
   </div>



   <div class="container">
     <div class="card-deck mb-0 text-center">
       <div class="card mb-6 shadow-sm">
         <div class="card-header">
           <h4 class="my-0 font-weight-normal">Customers</h4>
         </div>
         <div class="card-body">
           <table id="customers-table" class="table table-bordered table-striped display" style="width:100%">
        <thead>
            <tr>
                <th>Account</th>
                <th>Email</th>
                <th>F. Name</th>
                <th>L. Name</th>
                <th>Phone</th>
                <th>Preference</th>
            </tr>
        </thead>
        <tfoot>
          <tr>
              <th>Account</th>
              <th>Email</th>
              <th>F. Name</th>
              <th>L. Name</th>
              <th>Phone</th>
              <th>Preference</th>
          </tr>
        </tfoot>
    </table>

         </div>
         <button type="button" class="btn btn-success btn-lg" data-toggle="modal" data-target="#addcustomer">Add</button>


         <!-- Modal -->
<div class="modal fade" id="addcustomer" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add Customer</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
      <form id="addcustomer-frm" >
  <div class="form-group">
    <label for="AccountLabel">Account</label>
    <input type="number" class="form-control" name="add-account-txt" placeholder="1" required>
  </div>
  <div class="form-group">
    <label for="EmailLabel">Email</label>
    <input type="email" class="form-control" name="add-email-txt" placeholder="email@test.com" required>
  </div>
  <div class="form-group">
    <label for="FirstNameLabel">First Name</label>
    <input type="text" class="form-control" name="add-fname-txt" placeholder="John" required>
  </div>
  <div class="form-group">
    <label for="LastnameLabel">Last Name</label>
    <input type="text" class="form-control" name="add-lname-txt" placeholder="Doe" required>
  </div>
  <div class="form-group">
    <label for="PhoneLabel">Phone</label>
    <input type="tel" class="form-control" name="add-phone-txt" placeholder="5555-6666" required>
  </div>
  <div class="form-group">
    <label for="PreferneceLabel">Preference</label>
    <input type="text" class="form-control" name="add-preference-txt" placeholder="Email" required>
  </div>




      </div>
      <div class="modal-footer">
        <input  class="btn btn-success btn-lg" type="submit" value="Save">
        <button type="button" class="btn btn-secondary btn-lg" data-dismiss="modal">Close</button>
        </form>
      </div>
    </div>
  </div>
</div>

       </div>
       <div class="card mb-6 shadow-sm">
         <div class="card-header">
           <h4 class="my-0 font-weight-normal">Customers</h4>
         </div>
         <div class="card-body">
           <table id="transactions-table" class="table" style="width:100%">
        <thead>
            <tr>
                <th>ID</th>
                <th>Amount</th>
                <th>Acoount</th>
                <th>Date</th>
                <th>Merch. Name</th>
            </tr>
        </thead>
        <tfoot>
          <tr>
              <th>ID</th>
              <th>Amount</th>
              <th>Acoount</th>
              <th>Date</th>
              <th>Merch. Name</th>
          </tr>
        </tfoot>
    </table>
    <div class="btn-group btn-group-lg" role="group">...</div>
    <button type="button" class="btn btn-primary">Add</button>
    <button type="button" class="btn btn-info">Edit</button>
    <button type="button" class="btn btn-danger">Delete</button>
  </div>
         </div>
       </div>


     </div>

     <footer class="pt-4 my-md-5 pt-md-5 border-top">
       <div class="row">
         <div class="col-12 col-md">
           <small class="d-block mb-3 text-muted">&copy;Avaya</small>
         </div>

       </div>
     </footer>
   </div>



    <!-- JavaScript -->
    <script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/v/bs4/dt-1.10.18/b-1.5.2/cr-1.5.0/fc-3.2.5/fh-3.1.4/kt-2.4.0/sc-1.5.0/sl-1.2.6/datatables.min.js"></script>
    <script src="http://malsup.github.com/jquery.form.js"></script>

<script>

$(document).ready(function() {
  var postcustomer = {
         //target:        '#output1',   // target element(s) to be updated with server response
         beforeSubmit:  showRequest,  // pre-submit callback
         success:       showResponse,  // post-submit callback
         url:       'http://demo8742308.mockable.io/test',         // override for form's 'action' attribute
         type:      'post' ,       // 'get' or 'post', override for form's 'method' attribute
         dataType:  'json'        // 'xml', 'script', or 'json' (expected server response type)
         //clearForm: true        // clear all form fields after successful submit
         //resetForm: true        // reset the form after successful submit

         // $.ajax options can be used here too, for example:
         //timeout:   3000
     };

   $('#addcustomer-frm').ajaxForm(postcustomer);
  var events = $('#events');
  //Tabla 1
  var customerstbl = $('#customers-table').DataTable({
  	"destroy": "true",

  	"ajax": {
  		"url": "https://135.169.18.7/services/AAADEVURIELPrueba5/MyServlet",
  		"dataSrc": ""
  	},
  	"columns": [{
  			"data": "accountnum"
  		},
  		{
  			"data": "email"
  		},
  		{
  			"data": "firstname"
  		},
  		{
  			"data": "lastname"
  		},
  		{
  			"data": "phone"
  		},
  		{
  			"data": "preference"
  		}
  	],
  	"select": "single"
  });
  //Agregar Botones

  //FIN Tabla
  //Evento Seleccion tabla 1
  customerstbl.on('select', function (e, dt, type, indexes) {
  var rowData1 = customerstbl.rows(indexes).data().toArray();
  console.log(rowData1);
  var account = rowData1["0"].accountnum;
  console.log("Selected Account: " + account);


  var transactionstbl = $('#transactions-table').DataTable({
  	"destroy": "true",
  	"select": "single",
  	"ajax": {
  		"url": "https://135.169.18.7/services/AAADEVURIELPrueba5/transaction?accountnum=" + account,
  		"dataSrc": ""
  	},
  	"columns": [{
  			"data": "transid"
  		},
  		{
  			"data": "amount"
  		},
  		{
  			"data": "accountnum"
  		},
  		{
  			"data": "transdate"
  		},
  		{
  			"data": "merchantname"
  		}
  	],
  	"select": "true"
  });

  transactionstbl.destroy();


  })

  .on( 'deselect', function ( e, dt, type, indexes ) {
            var rowData = table.rows( indexes ).data().toArray();
            events.prepend( '<div><b>'+type+' <i>de</i>selection</b> - '+JSON.stringify( rowData )+'</div>' );
        } );

  //Fin evento
  });


  // pre-submit callback
function showRequest(formData, jqForm, options) {
    var queryString = $.param(formData);
    alert('About to submit: \n\n' + queryString);
    return true;
}

// post-submit callback
function showResponse(responseText, statusText, xhr, $form)  {
    alert('status: ' + statusText + '\n\nresponseText: \n' + responseText +
        '\n\nThe output div should have already been updated with the responseText.');
}
</script>

  </body>
</html>
